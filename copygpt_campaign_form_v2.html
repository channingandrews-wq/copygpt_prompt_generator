<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dora Campaign Intake</title>
  <style>
    :root{
      --bg:#ffffff;
      --panel:#f7f7f7;
      --text:#111111;
      --muted:#444444;
      --accent:#0b57d0;
      --danger:#c62828;
      --ok:#2e7d32;
      --border:#dddddd;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background:var(--bg);
      color:var(--text);
    }
    .container{max-width:1100px;margin:0 auto;padding:24px}
    h1{font-size:28px;margin:0 0 8px}
    p.lead{margin:0 0 24px;color:var(--muted)}
    form{display:grid;gap:14px}
    fieldset{border:1px solid var(--border);border-radius:14px;padding:16px;background:var(--panel)}
    legend{padding:0 8px;color:var(--muted)}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .row-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}
    .row-1{display:grid;grid-template-columns:1fr;gap:12px}
    label{display:block;font-weight:600;margin-bottom:6px}
    .desc{font-weight:500;color:var(--muted);font-size:13px;margin-top:4px}
    input[type="text"], input[type="date"], input[type="search"], select, textarea{
      width:100%;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:#fff;color:var(--text)
    }
    textarea{min-height:100px;resize:vertical}
    .hint{font-size:12px;color:var(--muted)}
    .required::after{content:" *";color:var(--danger);font-weight:700}
    .note{background:#fff;border-left:3px solid var(--accent);padding:10px 12px;border-radius:10px;color:var(--muted)}
    .error{color:var(--danger);font-size:13px;margin-top:6px;display:none}
    .hidden{display:none !important}
    .actions{display:flex;gap:10px;flex-wrap:wrap}
    button{appearance:none;border:1px solid var(--border);background:#ffffff;color:var(--text);padding:10px 14px;border-radius:12px;font-weight:700;cursor:pointer}
    button.primary{background:linear-gradient(135deg,#0b57d0,#3b82f6);border:none;color:#fff}
    button.ghost{background:transparent}
    .output{white-space:pre-wrap;background:#fff;border:1px dashed #cfcfcf;border-radius:12px;padding:14px;min-height:120px}
    .copy-section {margin-top: 10px;text-align: center;}
    .support-msg{color:var(--danger);font-weight:600}
  </style>
</head>
<body>
  <div class="container">
    <h1>Dora Prompt Generator 9/9 7pm</h1>
    <p class="lead">Fill out the form to generate a complete prompt for you. The fields will update as you make selections.</p>

    <form id="intakeForm" novalidate>
      <!-- Audience -->
      <fieldset>
        <legend>Audience</legend>
        <div class="row">
          <div>
            <label for="audience" class="required">What audience are you building your campaign for?</label>
            <select id="audience" required>
              <option value="" selected disabled>Select audience</option>
              <option>Consumer</option>
              <option>Dasher</option>
              <option>Merchant</option>
              <option>PR Communicaton</option>
            </select>
            <div class="error" id="audienceErr">Audience is required.</div>
          </div>
        </div>
      </fieldset>

      <!-- CONSUMER -->
      <fieldset id="consumerBlock" class="hidden">
        <legend>Consumer Campaign Details</legend>
        <div class="row">
          <div>
            <label for="channel" class="required">For which channel is your asset?</label>
            <select id="channel" required>
              <option value="" selected disabled>Select channel</option>
              <option>Email</option>
              <option>Push Notification</option>
              <option>Paid Media</option>
              <option>Paid Social</option>
              <option>Long-form Content</option>
              <option>In-app Merchandising</option>
            </select>
            <div class="error" id="channelErr">Channel is required.</div>
          </div>
        </div>
        <div id="unsupportedMsg" class="note hidden">
          <span class="support-msg">CopyGPT does not currently support these channels.</span>
        </div>

        <!-- Email/Push only -->
        <div id="epBlock" class="hidden">
          <div class="row">
            <div>
              <label for="segment" class="required">What is your Audience Segment?</label>
              <select id="segment" required>
                <option value="" selected disabled>Select segment</option>
                <option>Active Consumer</option>
                <option>Churned Consumer</option>
                <option>DashPass Member</option>
                <option>Dormant Consumer</option>
                <option>New Consumer</option>
              </select>
              <div class="error" id="segmentErr">Audience Segment is required.</div>
            </div>
          </div>

          <div class="row">
            <div>
              <label for="behavior" class="required">What has this user done or not done recently? What’s their current mindset or situation?</label>
              <textarea id="behavior" placeholder="Start with &quot;who…?&quot; e.g., who haven’t ordered in 30 days and are craving convenience" required></textarea>
              <div class="hint">Please start your response with "who".</div>
              <div class="error" id="behaviorErr">This field is required and must start with "who".</div>
            </div>
          </div>

          <div class="row">
            <div>
              <label for="submarkets" class="required">Is this asset specific to a specific set of submarkets?</label>
              <textarea id="submarkets" placeholder="e.g., Phoenix, Denver, Minneapolis" required></textarea>
              <div class="error" id="submarketsErr">This field is required.</div>
            </div>
          </div>

          <div class="row">
            <div>
              <label for="usecase" class="required">What is your use case?</label>
              <select id="usecase" required>
                <option value="" selected disabled>Select use case</option>
                <option>Convert New Customers</option>
                <option>Reactivate Dormant Users</option>
                <option>Apology/Trust Recovery</option>
                <option>Promote New Feature, Service, Mx</option>
                <option>Drive Promo Redemptions</option>
                <option>Non-monetary engagement</option>
                <option>Other</option>
              </select>
              <div class="error" id="usecaseErr">Use case is required.</div>
            </div>
          </div>

          <div class="row">
            <div>
              <label for="action" class="required">What action do you want the consumer to take?</label>
              <textarea id="action" placeholder="What do you want them to do? What method, offer, or feature supports that action?" required></textarea>
              <div class="error" id="actionErr">This field is required.</div>
            </div>
          </div>

          <div class="row">
            <div>
              <label for="takeaway" class="required">What is the most important takeaway for the consumer?</label>
              <textarea id="takeaway" placeholder="What's the one thing you want them to remember? Is there a claim or value prop to substantiate it?" required></textarea>
              <div class="error" id="takeawayErr">This field is required.</div>
            </div>
          </div>

          <div class="row">
            <div>
              <label for="feature">Can you provide more details or context about the feature or service you’d like to highlight?</label>
              <textarea id="feature" placeholder="e.g., Snap EBT on grocery, DoubleDash, saved addresses"></textarea>
            </div>
          </div>

          <div class="row">
            <div>
              <label for="lob">What line of business is this focused on?</label>
              <select id="lob">
                <option value="" selected disabled>Select line of business</option>
                <option>Restaurant</option>
                <option>Grocery &amp; Convenience</option>
                <option>Retail</option>
                <option>Alcohol</option>
                <option>N/A</option>
              </select>
            </div>
            <div>
              <label for="cta">What is your primary CTA?</label>
              <select id="cta">
                <option value="" selected disabled>Select CTA</option>
                <option>Order now</option>
                <option>Get DashPass</option>
                <option>Sign up</option>
                <option>Upgrade now</option>
                <option>Activate now</option>
                <option>Shop now</option>
                <option>Order drinks</option>
                <option>Shop gifts</option>
                <option>See deals</option>
              </select>
            </div>
          </div>

<!-- Paid Media / Paid Social (Consumer) -->
<fieldset id="paidBlock" class="hidden">
  <legend>Paid Media / Paid Social</legend>

  <div class="row">
    <div>
      <label for="adPlatforms" class="required">What platform is your ad running on?</label>
      <select id="adPlatforms" multiple size="6">
        <option>Meta ad</option>
        <option>Snap ad</option>
        <option>TikTok ad</option>
        <option>YouTube Short ad</option>
        <option>Google Demand Gen/Display ad</option>
        <option>All paid channels</option>
      </select>
      <div class="hint">Hold Cmd/Ctrl to select more than one.</div>
      <div class="error" id="adPlatformsErr">Select at least one platform.</div>
    </div>
  </div>

 <div id="adTypeWrap" class="row hidden">
    <div>
      <label for="adType" class="required">What type of ad are you running?</label>
      <select id="adType">
        <option value="" selected disabled>Select ad type</option>
        <option>Static</option>
        <option>Video</option>
        <option>Static and Video</option>
      </select>
      <div class="error" id="adTypeErr">Ad type is required.</div>
    </div>
  </div>
</fieldset>
          
          <!-- Promotion toggle (Consumer) -->
          <fieldset>
            <legend>Promotion</legend>
            <div class="row">
              <div>
                <label for="hasPromo">Is there a promotion tied to your campaign?</label>
                <select id="hasPromo">
                  <option>No</option>
                  <option>Yes</option>
                </select>
              </div>
            </div>

            <div id="promoBlock" class="hidden">
              <div class="row">
                <div>
                  <label for="promoType" class="required">What is your primary promo deal</label>
                  <select id="promoType">
                    <option value="" selected disabled>Select promo type</option>
                    <option>X Off Your Order</option>
                    <option>Save Up To $X</option>
                    <option>$0 Delivery Fee</option>
                    <option>$ X off Delivery Fee</option>
                    <option>Other</option>
                  </select>
                  <div class="error" id="promoTypeErr">Promo Type is required.</div>
                </div>
                <div>
                  <label for="discount" class="required">What is the discount? Must include $ or %</label>
                  <input id="discount" type="text" placeholder="$10 or 20%" />
                  <div class="error" id="discountErr">Include $ or % (e.g., $10 or 20%).</div>
                </div>
              </div>

              <div class="row-3">
                <div>
                  <label for="startDate" class="required">Start date (mm/dd/yy)</label>
                  <input id="startDate" type="text" placeholder="mm/dd/yy" />
                  <div class="error" id="startErr">Use mm/dd/yy.</div>
                </div>
                <div>
                  <label for="endDate" class="required">End date (mm/dd/yy)</label>
                  <input id="endDate" type="text" placeholder="mm/dd/yy" />
                  <div class="error" id="endErr">Use mm/dd/yy.</div>
                </div>
                <div>
                  <label for="minSubtotal" class="required">Minimum subtotal (0 if none)</label>
                  <input id="minSubtotal" type="text" placeholder="e.g., 20 or 0" />
                  <div class="error" id="minErr">Enter a non-negative number.</div>
                </div>
              </div>

              <div class="row">
                <div>
                  <label for="maxDiscount" class="required">Max discount (0 if none)</label>
                  <input id="maxDiscount" type="text" placeholder="e.g., 25 or 0" />
                  <div class="error" id="maxErr">Enter a non-negative number.</div>
                </div>
                <div>
                  <label for="pickupOnly">Is this promotion for pickup orders only?</label>
                  <select id="pickupOnly">
                    <option>No</option>
                    <option>Yes</option>
                  </select>
                </div>
              </div>

              <div class="row">
                <div>
                  <label for="promoCode">What is the promotion code? (n/a if none)</label>
                  <input id="promoCode" type="text" placeholder="e.g., SAVE10 or n/a" />
                </div>
                <div>
                  <label for="dashpassOnly">Is this promotion for DashPass members only?</label>
                  <select id="dashpassOnly">
                    <option>No</option>
                    <option>Yes</option>
                  </select>
                </div>
              </div>
            </div>
          </fieldset>

          <!-- Secondary module (Consumer) -->
          <fieldset>
            <legend>Secondary Module</legend>
  <div class="row">
    <div>
      <label for="hasSecondary">Does your asset need a secondary module?</label>
      <select id="hasSecondary">
        <option>No</option>
        <option>Yes</option>
      </select>
      <p class="subtext">
        Add a secondary module if you’re featuring multiple categories or adding necessary context. 
        Keep the message clear, scannable, and distinct from the lead.
      </p>
    </div>
  </div>

            <div id="secondaryBlock" class="hidden">
              <div class="row">
                <div>
                  <label for="secondaryObjective">Provide the message objective of this secondary module</label>
                  <textarea id="secondaryObjective" placeholder="What value prop, product offering, or feature supports that action?
"></textarea>
                </div>
              </div>
              <div class="row">
                <div>
                  <label for="secondaryLOB">What line of business is this focused on?</label>
                  <select id="secondaryLOB">
                    <option value="" selected disabled>Select line of business</option>
                    <option>Restaurant</option>
                    <option>Grocery &amp; Convenience</option>
                    <option>Retail</option>
                    <option>Alcohol</option>
                    <option>N/A</option>
                  </select>
                </div>
                <div>
                  <label for="secondaryCTA">What is your CTA for this secondary module</label>
                  <select id="secondaryCTA">
                    <option value="" selected disabled>Select CTA</option>
                    <option>Order now</option>
                    <option>Get DashPass</option>
                    <option>Sign up</option>
                    <option>Upgrade now</option>
                    <option>Activate now</option>
                    <option>Shop now</option>
                    <option>Order drinks</option>
                    <option>Shop gifts</option>
                    <option>See deals</option>
                  </select>
                </div>
              </div>
            </div>
          </fieldset>
        </div>
      </fieldset>

      <!-- DASHER -->
      <fieldset id="dasherBlock" class="hidden">
        <legend>Dasher Campaign Details</legend>
        <div class="row">
          <div>
            <label for="d_channel" class="required">What channel is your asset?</label>
            <select id="d_channel" required>
              <option value="" selected disabled>Select channel</option>
              <option>Email</option>
              <option>Push Notification</option>
              <option>Paid Media</option>
              <option>Paid Social</option>
              <option>Long-Form Content</option>
              <option>In-app Merchandising</option>
            </select>
            <div class="error" id="d_channelErr">Channel is required.</div>
          </div>
        </div>

        <div class="row">
          <div>
            <label for="d_segment" class="required">What is your Audience Segment?</label>
            <select id="d_segment" required>
              <option value="" selected disabled>Select segment</option>
              <option>Active Dasher</option> 
              <option>ANFD Dasher</option>
              <option>Churned Dasher</option>
              <option>New Dasher</option>
            </select>
            <div class="error" id="d_segmentErr">Audience Segment is required.</div>
          </div>
        </div>

        <div class="row">
          <div>
            <label for="d_behavior" class="required">What has this Dasher done or not done recently? What’s their current mindset or situation?</label>
            <textarea id="d_behavior" placeholder="Start with &quot;who…?&quot;" required></textarea>
            <div class="hint">Please start your response with "who".</div>
            <div class="error" id="d_behaviorErr">This field is required and must start with "who".</div>
          </div>
        </div>

        <div class="row">
          <div>
            <label for="d_submarkets">Is this asset specific to a specific set of submarkets?</label>
            <textarea id="d_submarkets" placeholder="e.g., Phoenix, Denver, Minneapolis"></textarea>
          </div>
        </div>

        <div class="row">
          <div>
            <label for="d_usecase" class="required">What is your use case?</label>
            <select id="d_usecase" required>
              <option value="" selected disabled>Select use case</option>
              <option>First Dash Conversion (New Dx)</option>
              <option>Churn/Reactivation</option>
              <option>Promotions: Challenge/Streak/Boost</option>
              <option>Apology/Outage</option>
              <option>New Feature/Order Type</option>
              <option>Education/Retention</option>
              <option>Programs: Rewards/Crimson</option>
              <option>Other</option>
            </select>
            <div class="error" id="d_usecaseErr">Use Case is required.</div>
          </div>
        </div>

        <div class="row">
          <div>
            <label for="d_action" class="required">What action do you want the Dasher to take?</label>
            <textarea id="d_action" placeholder="What do you want them to do? What method, offer, or feature supports that action?" required></textarea>
            <div class="error" id="d_actionErr">This field is required.</div>
          </div>
        </div>

        <div class="row">
          <div>
            <label for="d_takeaway" class="required">What is the most important takeaway for the Dasher?</label>
            <textarea id="d_takeaway" placeholder="What's the one thing you want them to remember? Is there a claim or value prop to substantiate it?" required></textarea>
            <div class="error" id="d_takeawayErr">This field is required.</div>
          </div>
        </div>

        <div class="row">
          <div>
            <label for="d_feature">Can you provide more details or context about the feature or service you’d like to highlight?</label>
            <textarea id="d_feature"></textarea>
          </div>
        </div>

        <div class="row">
          <div>
            <label for="d_cta">What is your primary CTA?</label>
            <select id="d_cta">
              <option value="" selected disabled>Select CTA</option>
              <option>Dash now</option>
              <option>Download now</option>
              <option>Get started</option>
              <option>Learn more</option>
              <option>Activate now</option>
              <option>See deals</option>
              <option>Sign up</option>
            </select>
          </div>
        </div>
<!-- Paid Media / Paid Social (Dasher) -->
<fieldset id="d_paidBlock" class="hidden">
  <legend>Paid Media / Paid Social</legend>

  <div class="row">
    <div>
      <label for="d_adPlatforms" class="required">What platform is your ad running on?</label>
      <select id="d_adPlatforms" multiple size="6">
        <option>Meta ad</option>
        <option>Snap ad</option>
        <option>TikTok ad</option>
        <option>YouTube Short ad</option>
        <option>Google Demand Gen/Display ad</option>
        <option>All paid channels</option>
      </select>
      <div class="hint">Hold Cmd/Ctrl to select more than one.</div>
      <div class="error" id="d_adPlatformsErr">Select at least one platform.</div>
    </div>
  </div>

 <div id="d_adTypeWrap" class="row hidden">
    <div>
      <label for="d_adType" class="required">What type of ad are you running?</label>
      <select id="d_adType">
        <option value="" selected disabled>Select ad type</option>
        <option>Static</option>
        <option>Video</option>
        <option>Static and Video</option>
      </select>
      <div class="error" id="d_adTypeErr">Ad type is required.</div>
    </div>
  </div>
</fieldset>
        <!-- Promotion (Dasher) -->
        <fieldset>
          <legend>Promotion</legend>
          <div class="row">
            <div>
              <label for="d_hasPromo">Is there a promotion tied to your campaign?</label>
              <select id="d_hasPromo">
                <option>No</option>
                <option>Yes</option>
              </select>
            </div>
          </div>

          <div id="d_promoBlock" class="hidden">
            <div class="row">
              <div>
                <label for="d_promoType" class="required">What is your primary promotion?</label>
                <select id="d_promoType">
                  <option value="" selected disabled>Select promotion</option>
                  <option>Complete x dashers, receive $x</option>
                  <option>streaks</option>
                  <option>other</option>
                </select>
                <div class="error" id="d_promoTypeErr">Promotion type is required.</div>
              </div>
              <div id="d_otherWrap" class="hidden">
                <label for="d_otherPromo">If other, describe</label>
                <input id="d_otherPromo" type="text" placeholder="Describe your promotion" />
              </div>
            </div>

            <div class="row-3">
              <div>
                <label for="d_startDate" class="required">Start date (mm/dd/yy)</label>
                <input id="d_startDate" type="text" placeholder="mm/dd/yy" />
                <div class="error" id="d_startErr">Use mm/dd/yy.</div>
              </div>
              <div>
                <label for="d_endDate" class="required">End date (mm/dd/yy)</label>
                <input id="d_endDate" type="text" placeholder="mm/dd/yy" />
                <div class="error" id="d_endErr">Use mm/dd/yy.</div>
              </div>
              <div>
                <label for="d_minDeliveries" class="required">Minimum Deliveries (0 if none)</label>
                <input id="d_minDeliveries" type="text" placeholder="e.g., 10 or 0" />
                <div class="error" id="d_minErr">Enter a non-negative number.</div>
              </div>
            </div>

            <div class="row">
              <div>
                <label for="d_stdPayout" class="required">Standard Payout (must include $)</label>
                <input id="d_stdPayout" type="text" placeholder="$50" />
                <div class="error" id="d_stdErr">Must include $ (e.g., $50).</div>
              </div>
              <div>
                <label for="d_maxPayout" class="required">Max Payout (N/A if not applicable; must include $)</label>
                <input id="d_maxPayout" type="text" placeholder="$100 or N/A" />
                <div class="error" id="d_maxErr">Include $ or write N/A.</div>
              </div>
            </div>

            <!-- Streaks-only -->
            <div id="d_streaksBlock" class="hidden">
              <div class="row">
                <div>
                  <label for="d_consecDays" class="required">How many consecutive days are required to earn the payout?</label>
                  <input id="d_consecDays" type="text" placeholder="e.g., 3" />
                  <div class="error" id="d_daysErr">Enter a non-negative number.</div>
                </div>
                <div>
                  <label for="d_additionalPayout" class="required">Additional payout amount if more than minimum consecutive days</label>
                  <input id="d_additionalPayout" type="text" placeholder="$20" />
                  <div class="error" id="d_additionalErr">Must include $ (e.g., $20).</div>
                </div>
              </div>
            </div>
          </div>
        </fieldset>

        <!-- Secondary module (Dasher) -->
        <fieldset>
          <legend>Secondary Module</legend>
          <div class="row">
    <div>
      <label for="d_hasSecondary">Does your asset need a secondary module?</label>
      <select id="d_hasSecondary">
        <option>No</option>
        <option>Yes</option>
      </select>
      <p class="subtext">
        Add a secondary module if you’re featuring multiple categories or adding necessary context. 
        Keep the message clear, scannable, and distinct from the lead.
      </p>
    </div>
  </div>

          

          <div id="d_secondaryBlock" class="hidden">
            <div class="row">
              <div>
                <label for="d_secondaryObjective">Provide the message objective of this secondary module</label>
                <textarea id="d_secondaryObjective" placeholder="What do you want them to do? What method, offer, or feature supports that action?"></textarea>
              </div>
            </div>
            <div class="row">
              <div>
                <label for="d_secondaryLOB">What line of business is this focused on?</label>
                <select id="d_secondaryLOB">
                  <option value="" selected disabled>Select line of business</option>
                  <option>Restaurant</option>
                  <option>Grocery &amp; Convenience</option>
                  <option>Retail</option>
                  <option>Alcohol</option>
                  <option>N/A</option>
                </select>
              </div>
              <div>
                <label for="d_secondaryCTA">What is your CTA for this secondary module</label>
                <select id="d_secondaryCTA">
                  <option value="" selected disabled>Select CTA</option>
                  <option>Dash now</option>
                  <option>Get Download now</option>
                  <option>Get started</option>
                  <option>Learn more</option>
                  <option>Activate now</option>
                  <option>See deals</option>
                  <option>Sign up</option>
                </select>
              </div>
            </div>
          </div>
        </fieldset>
      </fieldset>

      <!-- MERCHANT (placeholder) -->
      <fieldset id="merchantBlock" class="hidden">
        <legend>Merchant</legend>
        <div class="note"><span class="support-msg">Merchant workflow not yet supported in this form.</span></div>
      </fieldset>

      <div class="actions">
        <button type="button" class="primary" id="generateBtn">Generate Response</button>
        <button type="reset" class="ghost" id="resetBtn">Reset</button>
      </div>

      <fieldset>
<legend>Generated Response</legend>
<div id="output" class="output" aria-live="polite"></div>
<div class="copy-section">
<button type="button" id="copyBtn">Copy Text</button>
</div>
</fieldset>
</form>
</div>

  <script>
    const el = (id) => document.getElementById(id);

    // Shared
    const audience = el('audience');
    const output = el('output');
    const copyBtn = el('copyBtn');
    const generateBtn = el('generateBtn');
    const resetBtn = el('resetBtn');
    

    // Consumer refs (kept from original & extended)
    const consumerBlock = el('consumerBlock');
    const channel = el('channel');
    const unsupportedMsg = el('unsupportedMsg');
    const epBlock = el('epBlock');

    const segment = el('segment');
    const behavior = el('behavior');
    const submarkets = el('submarkets');
    const usecase = el('usecase');
    const action = el('action');
    const takeaway = el('takeaway');
    const feature = el('feature');
    const lob = el('lob');
    const cta = el('cta');

    const paidBlock = el('paidBlock');
const adPlatforms = el('adPlatforms');
const adTypeWrap = el('adTypeWrap');
const adType = el('adType');

    const hasPromo = el('hasPromo');
    const promoBlock = el('promoBlock');
    const promoType = el('promoType');
    const discount = el('discount');
    const startDate = el('startDate');
    const endDate = el('endDate');
    const minSubtotal = el('minSubtotal');
    const maxDiscount = el('maxDiscount');
    const pickupOnly = el('pickupOnly');
    const promoCode = el('promoCode');
    const dashpassOnly = el('dashpassOnly');

    const hasSecondary = el('hasSecondary');
    const secondaryBlock = el('secondaryBlock');
    const secondaryObjective = el('secondaryObjective');
    const secondaryLOB = el('secondaryLOB');
    const secondaryCTA = el('secondaryCTA');

    // Dasher refs
    const dasherBlock = el('dasherBlock');
    const d_channel = el('d_channel');
    const d_segment = el('d_segment');
    const d_behavior = el('d_behavior');
    const d_submarkets = el('d_submarkets');
    const d_usecase = el('d_usecase');
    const d_action = el('d_action');
    const d_takeaway = el('d_takeaway');
    const d_feature = el('d_feature');
    const d_cta = el('d_cta');

    const d_paidBlock = el('d_paidBlock');
const d_adPlatforms = el('d_adPlatforms');
const d_adTypeWrap = el('d_adTypeWrap');
const d_adType = el('d_adType');
    
    const d_hasPromo = el('d_hasPromo');
    const d_promoBlock = el('d_promoBlock');
    const d_promoType = el('d_promoType');
    const d_otherWrap = el('d_otherWrap');
    const d_otherPromo = el('d_otherPromo');
    const d_startDate = el('d_startDate');
    const d_endDate = el('d_endDate');
    const d_minDeliveries = el('d_minDeliveries');
    const d_stdPayout = el('d_stdPayout');
    const d_maxPayout = el('d_maxPayout');
    const d_streaksBlock = el('d_streaksBlock');
    const d_consecDays = el('d_consecDays');
    const d_additionalPayout = el('d_additionalPayout');

    // Merchant placeholder
    const merchantBlock = el('merchantBlock');

    // Validation helpers
    const reDate = /^(0[1-9]|1[0-2])\/(0[1-9]|[12][0-9]|3[01])\/\d{2}$/; // mm/dd/yy
    const reMoneyNum = /^\d+(?:\.\d{1,2})?$/;

    function showError(id, show) {
      const e = el(id);
      if (!e) return;
      e.style.display = show ? 'block' : 'none';
    }
    function validateRequired(node, errId){ const ok = !!(node && node.value && node.value.trim().length); showError(errId, !ok); return ok; }
    function validateStartsWithWho(node, errId){ const v=(node.value||'').trim().toLowerCase(); const ok=v.length>0 && v.startsWith('who'); showError(errId,!ok); return ok; }
    function validateDate(node, errId){ const v=(node.value||'').trim(); const ok=reDate.test(v); showError(errId,!ok); return ok; }
    function validateNumber(node, errId){ const v=(node.value||'').trim(); const ok=reMoneyNum.test(v); showError(errId,!ok); return ok; }
    function validateHasDollar(node, errId){ const v=(node.value||'').trim().toLowerCase(); const ok = v.includes('$'); showError(errId, !ok); return ok; }
    function validateHasDollarOrNA(node, errId){ const v=(node.value||'').trim().toLowerCase(); const ok = v==='n/a' || v.includes('$'); showError(errId, !ok); return ok; }
function getMultiSelectValues(msEl){
  return Array.from(msEl?.selectedOptions || []).map(o => o.value);
}
function validateMultiRequired(msEl, errId){
  const ok = getMultiSelectValues(msEl).length > 0;
  showError(errId, !ok);
  return ok;
}
    // Visibility
    function updateVisibility(){
  // audience blocks
  consumerBlock.classList.toggle('hidden', audience.value!=='Consumer');
  dasherBlock.classList.toggle('hidden', audience.value!=='Dasher');
  merchantBlock.classList.toggle('hidden', audience.value!=='Merchant');

  if (audience.value==='Consumer'){
    const ch = channel.value;
    const isEP = ch==='Email' || ch==='Push Notification' || ch==='Paid Media' || ch==='Paid Social';
    epBlock.classList.toggle('hidden', !isEP);
    unsupportedMsg.classList.toggle('hidden', isEP || !ch);

    // NEW: Paid block + ad-type visibility
    const isPaid = ch==='Paid Media' || ch==='Paid Social';
    paidBlock.classList.toggle('hidden', !isPaid);

    const hasPlatform = getMultiSelectValues(adPlatforms).length > 0;
    adTypeWrap.classList.toggle('hidden', !hasPlatform);
  } else {
    unsupportedMsg.classList.add('hidden');
    epBlock.classList.add('hidden');
    paidBlock.classList.add('hidden');
  }

      if (audience.value === 'Dasher') {
  const ch = d_channel.value;

  // Only show segment for Email/Push
  const isEmailOrPush = ch === 'Email' || ch === 'Push Notification';
  d_segment.parentElement.parentElement.classList.toggle('hidden', !isEmailOrPush);

  // Paid block visibility
  const isPaid = ch === 'Paid Media' || ch === 'Paid Social';
  d_paidBlock.classList.toggle('hidden', !isPaid);

  // Show ad type only when a platform is selected
  const hasPlatform = getMultiSelectValues(d_adPlatforms).length > 0;
  d_adTypeWrap.classList.toggle('hidden', !hasPlatform);
}
  

  // promo/secondary (consumer)
  promoBlock.classList.toggle('hidden', hasPromo.value!=='Yes');
  secondaryBlock.classList.toggle('hidden', hasSecondary.value!=='Yes');

  // promo (dasher)
  d_promoBlock.classList.toggle('hidden', d_hasPromo.value!=='Yes');
  d_streaksBlock.classList.toggle('hidden', d_promoType.value!=='streaks');
  d_otherWrap.classList.toggle('hidden', d_promoType.value!=='other');
}

    // Generate
    function generateConsumer(){
  let valid = true;

  valid &&= validateRequired(channel, 'channelErr');
  const ch = channel.value;
  const isEP = ch==='Email' || ch==='Push Notification' || ch==='Paid Media' || ch==='Paid Social';

  if (isEP){
    valid &&= validateRequired(segment,'segmentErr');
    valid &&= validateStartsWithWho(behavior,'behaviorErr');
    valid &&= validateRequired(submarkets,'submarketsErr');
    valid &&= validateRequired(usecase,'usecaseErr');
    valid &&= validateRequired(action,'actionErr');
    valid &&= validateRequired(takeaway,'takeawayErr');

    // Paid Media / Paid Social extras
    if (ch==='Paid Media' || ch==='Paid Social'){
      valid &&= validateMultiRequired(adPlatforms, 'adPlatformsErr');
      // Only require ad type once a platform is chosen
      if (getMultiSelectValues(adPlatforms).length > 0){
        valid &&= validateRequired(adType, 'adTypeErr');
      }
    }

    if (hasPromo.value==='Yes'){
      valid &&= validateRequired(promoType,'promoTypeErr');
      valid &&= validateHasDollarOrPercent(discount,'discountErr');
      valid &&= validateDate(startDate,'startErr');
      valid &&= validateDate(endDate,'endErr');
      valid &&= validateNumber(minSubtotal,'minErr');
      valid &&= validateNumber(maxDiscount,'maxErr');
    }
  }

  if (!valid) return '';

  const aud = 'Consumer';
  const seg = segment.value || '';
  const beh = (behavior.value||'').trim();
  const loc = (submarkets.value||'').trim();
  const uc  = usecase.value || '';
  const callToAction = cta.value || 'N/A';
  const actVal = (action.value||'').trim() || 'N/A';
  const takeVal = (takeaway.value||'').trim() || 'N/A';

  let txt = '';

if (ch === 'Paid Media' || ch === 'Paid Social') {
  txt = `I need ${adType.value} for ${getMultiSelectValues(adPlatforms).join(', ')} for our DoorDash ${aud} team targeting ${seg} ${beh} in ${loc}. Use Case: ${uc}.
The main action we want the consumer to take: ${actVal}
The most important takeaway for Consumer: ${takeVal}
CTA: ${callToAction}.`;
} else {
  // your existing email/push/etc. template
  txt = `I need a(n) ${ch} for our DoorDash ${aud} team targeting ${seg} ${beh} in ${loc}. Use Case: ${uc}.
The main action we want the consumer to take: ${actVal}
The most important takeaway for Consumer: ${takeVal}
CTA: ${callToAction}.`;
}

  // Include Paid selections in output
  if (ch==='Paid Media' || ch==='Paid Social'){
    const platforms = getMultiSelectValues(adPlatforms);
    if (platforms.length){
      txt += `\nPlatforms: ${platforms.join(', ')}.`;
    }
    if (adType.value){
      txt += `\nAd type: ${adType.value}.`;
    }
  }

  if (hasPromo.value==='Yes'){
    const pType = promoType.value;
    const disc = (discount.value||'').trim();
    const start = (startDate.value||'').trim();
    const end = (endDate.value||'').trim();
    const min = Number((minSubtotal.value||'0').trim());
    const max = Number((maxDiscount.value||'0').trim());
    const pickOnly = pickupOnly.value==='Yes';
    const code = (promoCode.value||'').trim();
    const dpOnly = dashpassOnly.value==='Yes';

    txt += `\nThis campaign include a [${pType} promo]`;

    const money = (n)=> isNaN(n)?'0':n.toString();
    const minTxt = `$${money(min)}`;
    const maxTxt = `$${money(max)}`;

    if (pType==='Save Up To $X'){
      txt += `\nOffer: ${disc} off their next order of ${minTxt} up to ${maxTxt} – valid between ${start} and ${end}.`;
    } else if (pType==='X Off Your Order'){
      txt += `\nOffer: ${disc} off their next order of ${minTxt}– valid between ${start} and ${end}.`;
    } else if (pType==='$0 Delivery Fee'){
      txt += `\nOffer: $0 Delivery Fee off their next order of ${minTxt} – valid between ${start} and ${end}.`;
    } else if (pType==='$ X off Delivery Fee'){
      txt += `\nOffer: ${disc} off your Delivery Fee on their next order of ${minTxt} – valid between ${start} and ${end}.`;
    } else {
      txt += `\nOffer: ${disc} – valid between ${start} and ${end}.`;
    }

    if (pickOnly) txt += ' Pick up orders only.';
    if (dpOnly) txt += ' DashPass Members only.';
    if (code && code.toLowerCase()!=='n/a') txt += ` ${code}.`;
  }

  if (hasSecondary.value==='Yes'){
    const sObj = (secondaryObjective.value||'N/A').trim();
    const sLOB = secondaryLOB.value || 'N/A';
    const sCTA = secondaryCTA.value || 'N/A';
    txt += `\nAlso include a secondary message where the objective is ${sObj} focused on ${sLOB} and cta should be ${sCTA}`;
  }

  return txt.trim();

  // local helper (scoped same as your original)
  function validateHasDollarOrPercent(node, errId){
    const v=(node.value||'').trim();
    const ok = /[$%]/.test(v) && v.length>0;
    showError(errId,!ok);
    return ok;
  }
}
    
   function generateDasher(){
  let valid = true;
  valid &&= validateRequired(d_channel,'d_channelErr');
  valid &&= validateRequired(d_segment,'d_segmentErr');
  valid &&= validateStartsWithWho(d_behavior,'d_behaviorErr');
  valid &&= validateRequired(d_usecase,'d_usecaseErr');
  valid &&= validateRequired(d_action,'d_actionErr');
  valid &&= validateRequired(d_takeaway,'d_takeawayErr');

  // Paid Media / Paid Social extras validation
  if (d_channel.value==='Paid Media' || d_channel.value==='Paid Social'){
  const platforms = getMultiSelectValues(d_adPlatforms);
  if (platforms.length){
    txt += `\nPlatforms: ${platforms.join(', ')}.`;
  } else {
    txt += `\nPlatforms: N/A`;
  }

  if (d_adType.value){
    txt += `\nAd type: ${d_adType.value}.`;
  } else {
    txt += `\nAd type: N/A`;
  }

  // Promotion validation
  if (d_hasPromo.value==='Yes'){
    valid &&= validateRequired(d_promoType,'d_promoTypeErr');
    valid &&= validateDate(d_startDate,'d_startErr');
    valid &&= validateDate(d_endDate,'d_endErr');
    valid &&= validateNumber(d_minDeliveries,'d_minErr');
    valid &&= validateHasDollar(d_stdPayout,'d_stdErr');
    valid &&= validateHasDollarOrNA(d_maxPayout,'d_maxErr');

    if (d_promoType.value==='streaks'){
      valid &&= validateNumber(d_consecDays,'d_daysErr');
      valid &&= validateHasDollar(d_additionalPayout,'d_additionalErr');
    }
  }

  if (!valid) return '';

  const aud = 'Dasher';
  const ch = d_channel.value || '';
  const seg = d_segment.value || '';
  const beh = (d_behavior.value||'').trim();
  const loc = (d_submarkets.value||'').trim();
  const uc  = d_usecase.value || '';
  const callToAction = d_cta.value || 'N/A';
  const actVal = (d_action.value||'').trim() || 'N/A';
  const takeVal = (d_takeaway.value||'').trim() || 'N/A';

  // Always initialize txt with a base prompt
  let txt = `I need an ${ch} for our DoorDash ${aud} Retention team targeting ${seg} ${beh} in ${loc}. 
Use Case: ${uc}.
The main action we want the Dasher to take: ${actVal}
The most important takeaway for Dasher: ${takeVal}
CTA: ${callToAction}.`;

  // Append Paid Media / Paid Social details
  if (ch === 'Paid Media' || ch === 'Paid Social') {
  const platforms = getMultiSelectValues(d_adPlatforms);
  if (platforms.length) {
    txt += `\nPlatforms: ${platforms.join(', ')}.`;
  }
  if (d_adType.value) {
    txt += `\nAd type: ${d_adType.value}.`;
  }
}

  // Append promotion details
  if (d_hasPromo.value==='Yes'){
    const pType = d_promoType.value;
    const start = (d_startDate.value||'').trim();
    const end = (d_endDate.value||'').trim();
    const minDel = (d_minDeliveries.value||'0').trim();
    const stdPay = (d_stdPayout.value||'').trim();
    const maxPay = (d_maxPayout.value||'').trim();

    if (pType==='Complete x dashers, receive $x'){
      txt += `\nThis campaign includes a promotion:\nOffer: Get ${stdPay} when you complete ${minDel} between ${start} and ${end}`;
    } else if (pType==='streaks'){
      const days = (d_consecDays.value||'').trim();
      const addPay = (d_additionalPayout.value||'').trim();
      txt += `\nThis campaign includes a promotion:\nOffer: Get ${stdPay} when you complete ${minDel} for ${days} days plus an additional ${addPay} (max ${maxPay}) between ${start} and ${end}`;
    } else {
      const other = (d_otherPromo.value||'').trim();
      txt += `\nThis campaign includes a promotion:\nOffer: ${other || stdPay} between ${start} and ${end}`;
    }
  }

  // Append secondary module details
  if (el('d_hasSecondary').value==='Yes'){
    const sObj = (d_secondaryObjective.value||'N/A').trim();
    const sLOB = d_secondaryLOB.value || 'N/A';
    const sCTA = d_secondaryCTA.value || 'N/A';
    txt += `\nAlso include a secondary message where the objective is ${sObj}, focused on ${sLOB}, with CTA ${sCTA}.`;
  }

  return txt.trim();
}


    function gatherAndGenerate(){
      output.textContent='';
      let valid = true;
      valid &&= validateRequired(audience,'audienceErr');
      if (!valid) return;

      let text='';
      if (audience.value==='Consumer'){
        text = generateConsumer();
      } else if (audience.value==='Dasher'){
        text = generateDasher();
      } else if (audience.value==='Merchant'){
        text = 'Merchant workflow not yet supported in this form.';
      }
      output.textContent = (text||'').trim();
      if (text) output.scrollIntoView({behavior:'smooth', block:'center'});
    }

    function validateHasDollarOrPercent(node, errId){
      const v=(node.value||'').trim();
      const ok = /[$%]/.test(v) && v.length>0;
      showError(errId,!ok);
      return ok;
    }

    // Events
    // Events
audience.addEventListener('change', updateVisibility);
channel.addEventListener('change', updateVisibility);
d_channel.addEventListener('change', updateVisibility);


// NEW: reveal ad type once any platform is selected
adPlatforms.addEventListener('change', updateVisibility);
d_adPlatforms.addEventListener('change', updateVisibility);
hasPromo.addEventListener('change', updateVisibility);
hasSecondary.addEventListener('change', updateVisibility);
d_hasPromo.addEventListener('change', updateVisibility);
d_promoType.addEventListener('change', updateVisibility);

generateBtn.addEventListener('click', gatherAndGenerate);
copyBtn.addEventListener('click', async () => {
  const text = output.textContent.trim();
  if (!text) return;
  try{
    await navigator.clipboard.writeText(text);
    copyBtn.textContent = 'Copied!';
    copyBtn.style.borderColor = 'var(--ok)';
    setTimeout(()=>{copyBtn.textContent='Copy Text';copyBtn.style.borderColor='var(--border)';},1200);
  }catch(e){
    const ta=document.createElement('textarea');
    ta.value=text; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); document.body.removeChild(ta);
  }
});
resetBtn.addEventListener('click', ()=> setTimeout(updateVisibility, 0));

// init
updateVisibility();
  </script>
</body>
</html>
